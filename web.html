<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spending Tracker</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .form-container {
      background-color: #f5f5f5;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input, select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
    }
    button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 15px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background-color: #45a049;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    .action-buttons {
      margin-top: 15px;
      display: flex;
      gap: 10px;
    }
    .clear-btn {
      background-color: #f44336;
    }
    .clear-btn:hover {
      background-color: #d32f2f;
    }
    .export-btn {
      background-color: #2196F3;
    }
    .export-btn:hover {
      background-color: #0b7dda;
    }
  </style>
</head>
<body>
  <h1>Spending Tracker</h1>
  
  <div class="form-container">
    <h2>Add New Expense</h2>
    <div class="form-group">
      <label for="date">Date:</label>
      <input type="date" id="date" required>
    </div>
    <div class="form-group">
      <label for="amount">Amount:</label>
      <input type="number" id="amount" step="0.01" min="0" placeholder="0.00" required>
    </div>
    <div class="form-group">
      <label for="category">Category:</label>
      <select id="category" required>
        <option value="">-- Select Category --</option>
        <option value="Food">Food</option>
        <option value="Drinks">Drinks</option>
        <option value="Cafes">Cafes</option>
        <option value="Swimming tickets">Swimming tickets</option>
        <option value="Bus ticket">Bus ticket</option>
        <option value="Gaming center">Gaming center</option>
        <option value="Petrol">Petrol</option>
        <option value="Parking fee">Parking fee</option>
      </select>
    </div>
    <div class="form-group">
      <label for="notes">Notes (optional):</label>
      <input type="text" id="notes" placeholder="Add any additional details">
    </div>
    <button id="add-expense">Add Expense</button>
  </div>

  <h2>Expense Records</h2>
  <div id="summary">
    <p>Total expenses: $<span id="total-amount">0.00</span></p>
  </div>
  <table id="expenses-table">
    <thead>
      <tr>
        <th>Date</th>
        <th>Amount</th>
        <th>Category</th>
        <th>Notes</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="expenses-body">
      <!-- Expenses will be added here -->
    </tbody>
  </table>

  <div class="action-buttons">
    <button id="export-csv" class="export-btn">Export to CSV</button>
    <button id="clear-data" class="clear-btn">Clear All Data</button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Set default date to today
      document.getElementById('date').valueAsDate = new Date();
      
      // Initialize expenses array from localStorage or empty array
      let expenses = JSON.parse(localStorage.getItem('expenses')) || [];
      
      // Render expenses and update total
      renderExpenses();
      updateTotal();
      
      // Add expense form submission
      document.getElementById('add-expense').addEventListener('click', function() {
        const dateInput = document.getElementById('date');
        const amountInput = document.getElementById('amount');
        const categoryInput = document.getElementById('category');
        const notesInput = document.getElementById('notes');
        
        // Validate inputs
        if (!dateInput.value || !amountInput.value || !categoryInput.value) {
          alert('Please fill in all required fields (Date, Amount, Category)');
          return;
        }
        
        // Create new expense object
        const newExpense = {
          id: Date.now(), // Unique ID for each expense
          date: dateInput.value,
          amount: parseFloat(amountInput.value),
          category: categoryInput.value,
          notes: notesInput.value
        };
        
        // Add to expenses array
        expenses.push(newExpense);
        
        // Save to localStorage
        saveExpenses();
        
        // Render expenses and update total
        renderExpenses();
        updateTotal();
        
        // Reset form
        amountInput.value = '';
        notesInput.value = '';
        categoryInput.selectedIndex = 0;
        // Keep the date as is for consecutive entries
      });
      
      // Export to CSV
      document.getElementById('export-csv').addEventListener('click', function() {
        // Create CSV content
        let csvContent = 'Date,Amount,Category,Notes\n';
        expenses.forEach(expense => {
          csvContent += `${expense.date},${expense.amount},${expense.category},"${expense.notes}"\n`;
        });
        
        // Create download link
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'expenses.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      });
      
      // Clear all data
      document.getElementById('clear-data').addEventListener('click', function() {
        if (confirm('Are you sure you want to delete all expense data? This cannot be undone.')) {
          expenses = [];
          saveExpenses();
          renderExpenses();
          updateTotal();
        }
      });
      
      // Function to save expenses to localStorage
      function saveExpenses() {
        localStorage.setItem('expenses', JSON.stringify(expenses));
      }
      
      // Function to render expenses in the table
      function renderExpenses() {
        const tbody = document.getElementById('expenses-body');
        tbody.innerHTML = '';
        
        // Sort expenses by date (newest first)
        expenses.sort((a, b) => new Date(b.date) - new Date(a.date));
        
        expenses.forEach(expense => {
          const row = document.createElement('tr');
          
          // Format date for display
          const dateObj = new Date(expense.date);
          const formattedDate = dateObj.toLocaleDateString();
          
          row.innerHTML = `
            <td>${formattedDate}</td>
            <td>$${expense.amount.toFixed(2)}</td>
            <td>${expense.category}</td>
            <td>${expense.notes}</td>
            <td>
              <button class="delete-btn" data-id="${expense.id}">Delete</button>
            </td>
          `;
          
          tbody.appendChild(row);
        });
        
        // Add event listeners to delete buttons
        document.querySelectorAll('.delete-btn').forEach(button => {
          button.addEventListener('click', function() {
            const id = parseInt(this.getAttribute('data-id'));
            deleteExpense(id);
          });
        });
      }
      
      // Function to delete an expense
      function deleteExpense(id) {
        expenses = expenses.filter(expense => expense.id !== id);
        saveExpenses();
        renderExpenses();
        updateTotal();
      }
      
      // Function to update total amount
      function updateTotal() {
        const total = expenses.reduce((sum, expense) => sum + expense.amount, 0);
        document.getElementById('total-amount').textContent = total.toFixed(2);
      }
    });
  </script>
</body>
</html>